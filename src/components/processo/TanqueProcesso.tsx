import React from 'react';

interface TanqueProcessoProps {
  // Parâmetros do processo
  nivel: number; // 0-100%
  pressao?: number; // bar
  temperatura?: number; // °C
  
  // Estados dos instrumentos
  ltAtivo?: boolean;
  ptAtivo?: boolean;
  lshAtivo?: boolean;
  lslAtivo?: boolean;
  
  // Alarmes
  nivelAlto?: boolean; // LSH ativado
  nivelBaixo?: boolean; // LSL ativado
  
  // Customização
  corLiquido?: string;
  largura?: number;
  altura?: number;
  
  // Tags dos instrumentos
  tagTanque?: string;
  tagLT?: string;
  tagPT?: string;
  tagLSH?: string;
  tagLSL?: string;
  
  // Callbacks
  onInstrumentClick?: (instrument: string) => void;
}

const TanqueProcesso: React.FC<TanqueProcessoProps> = ({
  nivel = 50,
  pressao = 2.5,
  temperatura = 20,
  ltAtivo = true,
  ptAtivo = true,
  lshAtivo = true,
  lslAtivo = true,
  nivelAlto = false,
  nivelBaixo = false,
  corLiquido = '#3498db',
  largura = 241,
  altura = 338,
  tagTanque = 'T-101',
  tagLT = 'LT-101',
  tagPT = 'PT-101',
  tagLSH = 'LSH-101',
  tagLSL = 'LSL-101',
  onInstrumentClick = () => {}
}) => {
  
  // Detectar nível baixo (LSL) e alto (LSH)
  const isNivelBaixo = nivel <= 20;
  const isNivelAlto = nivel >= 85;

  return (
    <div className="tanque-processo-container" style={{ display: 'inline-block' }}>
      <svg 
        width={largura} 
        height={altura} 
        viewBox={`0 0 ${largura} ${altura}`} 
        fill="none" 
        xmlns="http://www.w3.org/2000/svg"
        style={{ background: 'transparent' }}
      >
        {/* LÍQUIDO DINÂMICO - RETÂNGULO SIMPLES DE BAIXO PARA CIMA */}
        {nivel > 0 && (
          <rect
            x="58"
            y={300 - (nivel / 100) * (300 - 59.5)}
            width="182"
            height={(nivel / 100) * (300 - 59.5)}
            fill={corLiquido}
            opacity="0.6"
          />
        )}

        {/* SVG ORIGINAL EXATAMENTE IGUAL */}
        <path d="M58 300L123 337.528H175L240 300M58 300H240M58 300V59.5M240 300V155.5V19.6843L148.501 1L58 19.6843V59.5M58 59.5H34M34 59.5V64H10V59.5M34 59.5V54.5H10V59.5M34 59.5H10M58 277.5H34M34 277.5V282H10V277.5M34 277.5V272.5H10V277.5M34 277.5H10" stroke="black" strokeWidth="0.5"/>

        {/* LSH-101 - MUDA COR QUANDO NÍVEL ALTO */}
        <g onClick={() => onInstrumentClick('LSH-101')} style={{ cursor: 'pointer' }}>
          <path d="M0.618164 50L0.618164 49.1455L1.375 48.999L1.375 43.8965L0.618164 43.75L0.618164 42.8906H1.375H2.80078H3.66016V43.75L2.80078 43.8965L2.80078 48.9062H4.80762L4.87598 47.8662H5.96484V50H0.618164ZM9.37793 50.1025C8.85384 50.1025 8.37695 50.0439 7.94727 49.9268C7.51758 49.8096 7.0944 49.6061 6.67773 49.3164V47.5977H7.78125L7.93262 48.6084C8.0791 48.7321 8.28092 48.833 8.53809 48.9111C8.79525 48.986 9.0752 49.0234 9.37793 49.0234C9.63509 49.0234 9.85156 48.9876 10.0273 48.916C10.2064 48.8444 10.3415 48.7435 10.4326 48.6133C10.527 48.4798 10.5742 48.3236 10.5742 48.1445C10.5742 47.9753 10.5319 47.8255 10.4473 47.6953C10.3659 47.5618 10.2292 47.4414 10.0371 47.334C9.84831 47.2233 9.59115 47.1175 9.26562 47.0166C8.70247 46.8506 8.23535 46.6699 7.86426 46.4746C7.49642 46.276 7.21973 46.04 7.03418 45.7666C6.85189 45.4899 6.76074 45.1579 6.76074 44.7705C6.76074 44.3864 6.86654 44.0479 7.07812 43.7549C7.29297 43.4587 7.58919 43.2259 7.9668 43.0566C8.3444 42.8874 8.7806 42.7995 9.27539 42.793C9.82227 42.7865 10.3057 42.8516 10.7256 42.9883C11.1488 43.125 11.5133 43.3154 11.8193 43.5596V45.1611H10.75L10.5645 44.1846C10.4408 44.1064 10.2731 44.0381 10.0615 43.9795C9.85319 43.9209 9.61556 43.8916 9.34863 43.8916C9.12077 43.8916 8.91895 43.9258 8.74316 43.9941C8.57064 44.0625 8.43392 44.1618 8.33301 44.292C8.2321 44.4222 8.18164 44.5801 8.18164 44.7656C8.18164 44.9251 8.22559 45.0651 8.31348 45.1855C8.40137 45.3027 8.54785 45.415 8.75293 45.5225C8.96126 45.6266 9.24772 45.7389 9.6123 45.8594C10.3968 46.0775 10.9909 46.3656 11.3945 46.7236C11.8014 47.0817 12.0049 47.5521 12.0049 48.1348C12.0049 48.5384 11.8958 48.8883 11.6777 49.1846C11.4596 49.4775 11.1536 49.7038 10.7598 49.8633C10.3659 50.0228 9.90527 50.1025 9.37793 50.1025ZM12.5713 50V49.1455L13.3281 48.999L13.3281 43.8965L12.5713 43.75V42.8906H15.5156V43.75L14.7539 43.8965V45.9473H17.6543V43.8965L16.8926 43.75V42.8906H17.6543H19.0752H19.8369V43.75L19.0752 43.8965V48.999L19.8369 49.1455V50H16.8926V49.1455L17.6543 48.999V47.0459H14.7539L14.7539 48.999L15.5156 49.1455V50H12.5713ZM20.75 47.5098V46.4111L23.5039 46.4111V47.5098H20.75ZM24.4121 50V49.1455L25.6133 48.999V44.1846H24.3975V43.3691L27.0342 42.8906V48.999L28.2354 49.1455V50L24.4121 50ZM31.4043 50.1025C30.6621 50.1025 30.0745 49.86 29.6416 49.375C29.2087 48.8867 28.9922 48.1722 28.9922 47.2314V45.6641C28.9922 44.7266 29.207 44.0137 29.6367 43.5254C30.0697 43.0339 30.6556 42.7881 31.3945 42.7881C32.1302 42.7881 32.7145 43.0339 33.1475 43.5254C33.5837 44.0137 33.8018 44.7266 33.8018 45.6641V47.2314C33.8018 48.1722 33.5853 48.8867 33.1523 49.375C32.7227 49.86 32.14 50.1025 31.4043 50.1025ZM31.4043 49.0088C31.7233 49.0088 31.9658 48.8786 32.1318 48.6182C32.2979 48.3577 32.3809 47.9411 32.3809 47.3682V45.5176C32.3809 44.9512 32.2962 44.5378 32.127 44.2773C31.9577 44.0169 31.7135 43.8867 31.3945 43.8867C31.0723 43.8867 30.8281 44.0169 30.6621 44.2773C30.4961 44.5378 30.4131 44.9512 30.4131 45.5176V47.3682C30.4131 47.9411 30.4961 48.3577 30.6621 48.6182C30.8314 48.8786 31.0788 49.0088 31.4043 49.0088ZM34.5488 50V49.1455L35.75 48.999V44.1846H34.5342V43.3691L37.1709 42.8906V48.999L38.3721 49.1455V50H34.5488Z" 
            fill={isNivelAlto ? "#e74c3c" : "black"}
          />
        </g>

        {/* LSL-101 - MUDA COR QUANDO NÍVEL BAIXO */}
        <g onClick={() => onInstrumentClick('LSL-101')} style={{ cursor: 'pointer' }}>
          <path d="M1.59473 269L1.59473 268.146L2.35156 267.999L2.35156 262.896L1.59473 262.75L1.59473 261.891H2.35156H3.77734H4.63672V262.75L3.77734 262.896L3.77734 267.906H5.78418L5.85254 266.866H6.94141V269H1.59473ZM10.3545 269.103C9.8304 269.103 9.35352 269.044 8.92383 268.927C8.49414 268.81 8.07096 268.606 7.6543 268.316V266.598H8.75781L8.90918 267.608C9.05566 267.732 9.25749 267.833 9.51465 267.911C9.77181 267.986 10.0518 268.023 10.3545 268.023C10.6117 268.023 10.8281 267.988 11.0039 267.916C11.1829 267.844 11.318 267.743 11.4092 267.613C11.5036 267.48 11.5508 267.324 11.5508 267.145C11.5508 266.975 11.5085 266.826 11.4238 266.695C11.3424 266.562 11.2057 266.441 11.0137 266.334C10.8249 266.223 10.5677 266.118 10.2422 266.017C9.67904 265.851 9.21191 265.67 8.84082 265.475C8.47298 265.276 8.19629 265.04 8.01074 264.767C7.82845 264.49 7.7373 264.158 7.7373 263.771C7.7373 263.386 7.8431 263.048 8.05469 262.755C8.26953 262.459 8.56576 262.226 8.94336 262.057C9.32096 261.887 9.75716 261.799 10.252 261.793C10.7988 261.786 11.2822 261.852 11.7021 261.988C12.1253 262.125 12.4899 262.315 12.7959 262.56V264.161H11.7266L11.541 263.185C11.4173 263.106 11.2497 263.038 11.0381 262.979C10.8298 262.921 10.5921 262.892 10.3252 262.892C10.0973 262.892 9.89551 262.926 9.71973 262.994C9.5472 263.062 9.41048 263.162 9.30957 263.292C9.20866 263.422 9.1582 263.58 9.1582 263.766C9.1582 263.925 9.20215 264.065 9.29004 264.186C9.37793 264.303 9.52441 264.415 9.72949 264.522C9.93783 264.627 10.2243 264.739 10.5889 264.859C11.3734 265.077 11.9674 265.366 12.3711 265.724C12.778 266.082 12.9814 266.552 12.9814 267.135C12.9814 267.538 12.8724 267.888 12.6543 268.185C12.4362 268.478 12.1302 268.704 11.7363 268.863C11.3424 269.023 10.8818 269.103 10.3545 269.103ZM13.5479 269V268.146L14.3047 267.999L14.3047 262.896L13.5479 262.75V261.891H14.3047H15.7305H16.5898V262.75L15.7305 262.896L15.7305 267.906H17.7373L17.8057 266.866H18.8945V269H13.5479ZM19.7734 266.51V265.411H22.5273V266.51H19.7734ZM23.4355 269V268.146L24.6367 267.999V263.185H23.4209V262.369L26.0576 261.891V267.999L27.2588 268.146V269H23.4355ZM30.4277 269.103C29.6855 269.103 29.098 268.86 28.665 268.375C28.2321 267.887 28.0156 267.172 28.0156 266.231V264.664C28.0156 263.727 28.2305 263.014 28.6602 262.525C29.0931 262.034 29.679 261.788 30.418 261.788C31.1536 261.788 31.738 262.034 32.1709 262.525C32.6071 263.014 32.8252 263.727 32.8252 264.664V266.231C32.8252 267.172 32.6087 267.887 32.1758 268.375C31.7461 268.86 31.1634 269.103 30.4277 269.103ZM30.4277 268.009C30.7467 268.009 30.9893 267.879 31.1553 267.618C31.3213 267.358 31.4043 266.941 31.4043 266.368V264.518C31.4043 263.951 31.3197 263.538 31.1504 263.277C30.9811 263.017 30.737 262.887 30.418 262.887C30.0957 262.887 29.8516 263.017 29.6855 263.277C29.5195 263.538 29.4365 263.951 29.4365 264.518V266.368C29.4365 266.941 29.5195 267.358 29.6855 267.618C29.8548 267.879 30.1022 268.009 30.4277 268.009ZM33.5723 269V268.146L34.7734 267.999V263.185H33.5576V262.369L36.1943 261.891V267.999L37.3955 268.146V269H33.5723Z" 
            fill={isNivelBaixo ? "#e74c3c" : "black"}
          />
        </g>

        {/* NÍVEL PERCENTUAL */}
        <text 
          x="120" y="30" 
          textAnchor="middle" 
          fontSize="16" 
          fontWeight="bold" 
          fill="#2c3e50"
        >
          {nivel.toFixed(1)}%
        </text>

        {/* TAG DO TANQUE */}
        <text 
          x="120" y="320" 
          textAnchor="middle" 
          fontSize="14" 
          fontWeight="bold" 
          fill="#2c3e50"
        >
          {tagTanque}
        </text>

        {/* INDICADORES DE ALARME */}
        {(isNivelAlto || isNivelBaixo) && (
          <circle 
            cx="25" cy="25" 
            r="6" 
            fill="#e74c3c"
          >
            <animate 
              attributeName="opacity" 
              values="0.3;1;0.3" 
              dur="1s" 
              repeatCount="indefinite"
            />
          </circle>
        )}
      </svg>
    </div>
  );
};

export default TanqueProcesso;